plugins {
  id "application"
}

repositories {
  mavenCentral()
  mavenLocal()
}

dependencies {
  implementation "org.apache.spark:spark-sql_2.12:3.4.1"
  implementation "org.jcommander:jcommander:1.83"
  implementation "com.marklogic:marklogic-spark-connector:2.2-SNAPSHOT"

  // TODO We'll have to see if we always include this for reading from S3; it adds a lot of dependencies to the final
  // zip file.
  implementation "org.apache.hadoop:hadoop-aws:3.3.6"
  implementation "org.apache.hadoop:hadoop-client:3.3.6"

  testImplementation "com.marklogic:marklogic-junit5:1.4.0"

  testImplementation "org.postgresql:postgresql:42.6.0"
}

application {
  mainClass = "com.marklogic.newtool.Main"
}

startScripts {
  unixStartScriptGenerator.template = resources.text.fromFile('scripts/start-script.txt')
  applicationName = "nt"
}

tasks.register("buildTool", Copy) {
  from layout.buildDirectory.dir("install/new-tool-cli")
  into "../nt"
}
buildTool.dependsOn installDist
